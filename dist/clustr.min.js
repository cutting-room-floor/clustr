clustr={},clustr.resolutions=function(){var a=[],b=156543.03390625;for(var c=0;c<=30;++c)a[c]=b/Math.pow(2,c);return a}(),clustr.forwardMercator=function(a){var b=a.geometry.coordinates[0],c=a.geometry.coordinates[1],d=b*20037508.34/180,e=Math.log(Math.tan((90+c)*Math.PI/360))/(Math.PI/180);return e=e*20037508.34/180,{x:d,y:e}},clustr.dist=function a(a,b){var c=clustr.forwardMercator(a),d=clustr.forwardMercator(b);return Math.sqrt(Math.pow(c.x-d.x,2)+Math.pow(c.y-d.y,2))},clustr.area_to_radius=function(a){var b=Math.round(Math.sqrt(a/Math.PI));return b};var scale_factory_cache={};clustr.scale_factory=function(a,b,c){return function(d){if(!a)throw"getRadius must be specified";var e=a(d),f=e*2;if(f===0)return null;if(!scale_factory_cache[e]){var g=document.createElement("canvas");g.width=f,g.height=f;var h=g.getContext("2d");h.fillStyle=b||"rgba(197, 126, 163, 0.5)",h.strokeStyle=c||"#A63F74",h.beginPath(),h.arc(e,e,e*.95,0,Math.PI*2,!0),h.closePath(),h.fill(),h.stroke(),scale_factory_cache[e]=g.toDataURL()}var i=document.createElement("img");return i.width=f,i.height=f,i.src=scale_factory_cache[e],i.style.cssText="width:"+f+"px;"+"height:"+f+"px;"+"margin-left:"+ -e+"px;"+"margin-top:"+ -e+"px;"+"position:absolute",i}},clustr.merge_intersecting=function(a,b,c,d){var e=a.slice();for(var f=0;f<e.length;f++)for(var g=0;g<e.length;g++){if(f===g)continue;var h=clustr.dist(e[f],e[g])/clustr.resolutions[d],i=b(e[f])+b(e[g]);if(h<i){var j=(e[f].total||1)+(e[g].total||1);e[f].total=j,c(e[f],e[g]),e.splice(g,1),f=0}}return e}